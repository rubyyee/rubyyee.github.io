<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
    #map-container { position: relative; width: 100%; height: 450px; border-radius: 8px; overflow: hidden; margin: 20px 0; border: 1px solid #333; }
    #map { height: 100%; width: 100%; }
    .map-nav { position: absolute; top: 10px; right: 10px; z-index: 1000; background: rgba(11, 17, 33, 0.9); padding: 10px; border-radius: 4px; border: 1px solid #444; }
    .map-nav button { display: block; width: 100%; background: none; border: none; color: #00d4ff; text-align: left; cursor: pointer; padding: 5px; font-size: 0.85rem; font-family: inherit; }
    .map-nav button:hover { color: white; text-decoration: underline; }
    .map-nav span { color: #888; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1px; }
</style>

<div id="map-container">
    <div id="map"></div>
    <div class="map-nav">
        <span>Jump to Region:</span>
        <button onclick="flyToLoc([44.66, -63.57], 12)">Halifax Projects</button>
        <button onclick="flyToLoc([75.0, -100.0], 3)">Arctic Observations</button>
        <button onclick="flyToLoc([40, -40], 3)">Global View</button>
    </div>
</div>

<script>
    // Check if map is already initialized to prevent errors on re-renders
    if (typeof map !== 'undefined') {
        map.remove();
    }
    
    var map = L.map('map').setView([44.66, -63.57], 3);

    // Using a clean, professional dark-mode tile layer
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
        attribution: '&copy; OpenStreetMap &copy; CARTO'
    }).addTo(map);

    var locations = [
        { name: "Tufts Cove (Dye Tracer)", coords: [44.677, -63.593], desc: "Near-field plume dye release." },
        { name: "Bedford Basin Transects", coords: [44.69, -63.63], desc: "Monthly oceanographic monitoring." },
        { name: "Arctic Ocean", coords: [78.0, -120.0], desc: "Turbulence observations from temperature microstructure." }
    ];

    locations.forEach(function(loc) {
        L.marker(loc.coords).addTo(map).bindPopup("<b>" + loc.name + "</b><br>" + loc.desc);
    });

    function flyToLoc(coords, zoom) {
        map.flyTo(coords, zoom, { duration: 2 });
    }
</script>